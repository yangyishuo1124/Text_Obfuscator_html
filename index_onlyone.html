<!DOCTYPE html>
<html lang="en">
<head onload="brython()">
    <meta charset="UTF-8">
    <title>HelloWorld</title>
    <script type="text/javascript" src="brython.js"></script>
    <script type="text/javascript" src="brython_stdlib.js"></script>
    <script type="text/javascript" src="jquery.min.js"></script>
    <!--<script type="text/python" src="main.py"></script>-->
</head>
<body onload="brython()">
    <script type="text/python">
        from browser import window
        class jiami(object):
            def __init__(self, key: str, data: str):
                # 密钥和内容长度
                self.key = key
                self.key_add = 0
                if self.key.isdigit():
                    if len(self.key) > 5:
                        for i in self.key:
                            self.key_add += int(i)
                    else:
                        self.key_add = int(self.key)
                else:
                    for i in self.key:
                        self.key_add += int(ord(i))
                self.data = data
                self.jiami_result_list = []
                self.jiami_result = ''

            def jiami(self):
                for i in self.data:
                    self.jiami_result_list.append(chr(ord(i) + self.key_add))
                for i in self.jiami_result_list:
                    self.jiami_result += i

            def result(self):
                return self.jiami_result


        class jiemi(object):
            def __init__(self,key: str,data: str):
                self.key = key
                self.key_add= 0
                if self.key.isdigit():
                    if len(self.key) > 5:
                        for i in self.key:
                            self.key_add += int(i)
                    else:
                        self.key_add = int(self.key)
                else:
                    for i in self.key:
                        self.key_add += int(ord(i))
                self.data = data
                self.jiemi_result_list = []
                self.jiemi_result = ''
            def jiemi(self):
                for i in self.data:
                    try:
                        self.jiemi_result_list.append(chr(ord(i) - self.key_add))
                    except ValueError:
                        self.jiemi_result = '输入的内容不是密文'
                        break
                for i in self.jiemi_result_list:
                    self.jiemi_result += i

            def result(self):
                return self.jiemi_result



        def jiamimain(key, data):
            # jiami
            if len(key) >= 8:
                return '密钥长度错误,请重新输入(密钥长度不能大于8)'
            elif len(data) == 0:
                return '内容不能为空'
            elif len(key) == 0:
                return '密钥不能为空'
            else:
                a = jiami(key, data)
                a.jiami()
                return a.result()


        def jiemimain(key, data):
            # jiemi
            if len(key) >= 8:
                return '密钥长度错误,请重新输入(密钥长度不能大于8)'
            elif len(data) == 0:
                return '内容不能为空'
            elif len(key) == 0:
                return '密钥不能为空'
            else:
                a = jiemi(key, data)
                a.jiemi()
                return a.result()



        window.encodemain = jiamimain
        window.decodemain = jiemimain
    </script>
    <script type="text/javascript" >
        function encrypt_fun(key,data){
            const result = encodemain(key, data);
            $("#result").text('加密的结果是:'+result);
        }
        function decrypt_fun(key,data){
            const result = decodemain(key, data);
            $("#result").text('解密的结果是:'+result);
        }
    </script>

<form name="数据">
    <label>
        <textarea name="data" cols="30" rows="10" placeholder="请输入需要加密或解密的文字"></textarea>
        <div><input name="key" placeholder="请输入密钥"/></div>
        <button type="button" name="encrypt" onclick="encrypt_fun(数据.key.value,数据.data.value)">加密</button>
        <button type="button" name="decrypt" onclick="decrypt_fun(数据.key.value,数据.data.value)">解密</button>
    </label>
</form>
    <p id="result"></p>
    <div>Tip:密钥不可为空，不可大于8位</div>
</body>
</html>